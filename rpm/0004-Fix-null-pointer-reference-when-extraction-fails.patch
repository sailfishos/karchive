From f10660781deff862975da9f4067ee6c36521eb08 Mon Sep 17 00:00:00 2001
From: Pekka Vuorela <pekka.vuorela@jolla.com>
Date: Fri, 11 Oct 2019 15:00:42 +0300
Subject: [PATCH 4/4] Fix null pointer reference when extraction fails

---
 src/karchive.cpp | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/karchive.cpp b/src/karchive.cpp
index 0ad4268..53733e6 100644
--- a/src/karchive.cpp
+++ b/src/karchive.cpp
@@ -740,6 +740,10 @@ bool KArchiveFile::copyTo(const QString &dest, bool autoRename, QString *outFile
     QFile f(fileName);
     if (f.open(QIODevice::ReadWrite | QIODevice::Truncate)) {
         QIODevice *inputDev = createDevice();
+        if (!inputDev) {
+            f.remove();
+            return false;
+        }
 
         // Read and write data in chunks to minimize memory usage
         const qint64 chunkSize = 1024 * 1024;
-- 
2.21.0

